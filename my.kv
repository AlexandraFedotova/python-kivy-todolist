#:kivy 1.0

#MDScreen
<TaskCreationScreen>:
    name: 'taskCreation'
    button_task_creation: button_task_creation
    textfield_task_name: textfield_task_name
    textfield_task_description: textfield_task_description

    MDBoxLayout:
        orientation: 'vertical'

        MDTopAppBar:
            title: 'Task creation'
            opposite_colors: True
            elevation: 10

            left_action_items: [["arrow-left", lambda x: app.set_screen('tasksInCategory')]]

        MDBoxLayout:
            orientation: 'vertical'
            padding: 20

            MDTextField:
                id: textfield_task_name
                hint_text: 'Task name ...'
                write_tab: False
                write_enter: False
                multiline: True

                on_text:
                    if self.text.strip() == '': root.button_task_creation.disabled=True
                    else: root.button_task_creation.disabled=False

            MDTextField:
                id: textfield_task_description
                hint_text: 'Task description ...'
                multiline: True

            MDFlatButton:
                id: button_task_creation
                text: 'Create'
                disabled: True
                pos_hint: {"center_x": 0.5, "center_y": 0.5}

                on_release:
                    root.create_task(app.current_category)

#TwoLineAvatarIconListItem
<TaskItem>:
    checkbox: checkbox

    on_release: app.create_task_only_screen(self)

    text: 'Task name'
    secondary_text: 'Task description'

    CheckboxLeftWidget:
        id: checkbox
        on_release:
            root.checkbox_action()


# MDScreen
<TasksInCategoryScreen>:
    name: 'tasksInCategory'

    task_list: task_list
    toolbar: toolbar

    on_pre_enter:
        self.set_tasks_list(app.current_category)

    MDBoxLayout:
        orientation: 'vertical'

        MDTopAppBar:
            id: toolbar
            title: 'Category'
            opposite_colors: True
            elevation: 10

            right_action_items: [["plus", lambda x: app.set_screen('taskCreation')]]
            left_action_items: [["arrow-left", lambda x: app.set_screen('categoriesList')]]

        ScrollView:
            scroll_timeout: 100
            size_hint: 1, 1
            do_scroll_x: False

            MDList:
                id: task_list
                padding: '2sp'

#OneLineRightIconListItem
<CategoryItem>:
    on_release: app.show_tasks_in_categories_screen(self.text)

    text: 'Category name'

    IconRightWidget:
        icon: "trash-can"
        on_release: app.screen_manager.get_screen('categoriesList').show_dialog_delete_category(root)

#MDScreen
<CategoriesListScreen>:
    name: 'categoriesList'

    categories_list: categories_list

    on_pre_enter: self.set_categories_list()

    MDBoxLayout:
        orientation: 'vertical'

        MDTopAppBar:
            title: app.title
            opposite_colors: True
            elevation: 10

            right_action_items: [["plus", lambda x: root.show_dialog_create_category()]]

        ScrollView:
            scroll_timeout: 100
            size_hint: 1, 1
            do_scroll_x: False

            MDList:
                id: categories_list
                padding: '2sp'


<TaskOnlyScreen>:
    name: 'taskOnly'

    task_name: task_name
    task_description: task_description
    task_is_done: task_is_done
    task_category: task_category

    MDBoxLayout:
        orientation: 'vertical'

        MDTopAppBar:
            title: 'Task'
            opposite_colors: True
            elevation: 10

            left_action_items: [["arrow-left", lambda x: app.remove_task_only_screen()]]
            right_action_items: [["trash-can", lambda x: app.remove_task(root)]]

        MDGridLayout:
            cols: 1
            padding: '10sp'
            spacing: '10sp'

            MDBoxLayout:
                size_hint: 1, None
                height: root.task_name.height
                padding: 0
                spacing: 0

                MDCheckbox:
                    id: task_is_done
                    on_release: root.set_is_done()
                    size_hint_x: None
                    width: 50
                    pos_hint_y: .5

                MDTextField:
                    id: task_name
                    mode: 'fill'
                    radius: 10, 10, 10, 10
                    multiline: True
                    write_tab: False
                    write_enter: False
                    font_size: '20sp'
                    fill_color_normal: 1, 1, 1, 1
                    text_color_normal: 0, 0, 0, 1
                    size_hint_x: None
                    width: root.width - 80
                    pos_hint_y: .5

                    on_text: root.set_name()

            MDTextField:
                id: task_category
                mode: 'fill'
                radius: 10, 10, 10, 10
                multiline: False
                write_tab: False
                write_enter: False
                fill_color_normal: 1, 1, 1, 1
                text_color_normal: 0, 0, 0, 1
                size_hint_x: None
                width: root.width - 20
                pos_hint_y: .5

                on_text: root.set_category()


            MDTextField:
                id: task_description
                mode: 'fill'
                radius: 10, 10, 10, 10
                multiline: True
                font_size: '18sp'
                size_hint_x: None
                width: root.width - 20

                text_color_normal: 0, 0, 0, 1
                fill_color_normal: 1, 1, 1, 1

                on_text: root.set_description()

#ScreenManager
<MainApp>:
    CategoriesListScreen:

    TasksInCategoryScreen:

    TaskCreationScreen:


